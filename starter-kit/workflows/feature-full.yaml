# Feature Full Workflow
# Complete workflow with validation checkpoints

name: feature-full
displayName: "Feature with Validation"
description: "Complete feature workflow with security and RGPD validations"

metadata:
  version: "3.0"
  author: "Spec-Kit"
  tags:
    - feature
    - governance
    - validation

template: functional-spec.md
defaultAgent: SpecAgent

steps:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 1: SPECIFICATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: create-spec
    name: "1. Create Specification"
    action: call_agent
    agent: SpecAgent
    description: |
      Create a comprehensive functional specification.
      
      Include:
      - Feature summary and objectives
      - User stories with acceptance criteria
      - Functional requirements
      - Non-functional requirements
      - Data requirements
      - Dependencies and constraints
      
      Mark unclear sections with [NEEDS CLARIFICATION] for review.
    inputs:
      - name: requirements
        description: "Feature description from user"
        required: true
    outputs:
      - spec_document
    # Require approval before proceeding to validation phase
    requiresApproval: true
    approvalMessage: "Review the specification before security/RGPD validation"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 2: VALIDATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: security-review
    name: "2.1 ğŸ”’ Security Review"
    action: review
    agent: GovAgent
    # Use subagent for isolated context during security analysis
    useSubagent: true
    description: |
      Security assessment based on the specification:
      
      **Authentication & Authorization**
      - [ ] Auth mechanism defined
      - [ ] Role-based access control
      - [ ] Session management
      
      **Data Protection**
      - [ ] Encryption requirements
      - [ ] Sensitive data handling
      
      **Input/Output Security**
      - [ ] Input validation strategy
      - [ ] Output encoding
      - [ ] Injection prevention
      
      Identify any security concerns and recommendations.
    inputs:
      spec: "spec_document"
    outputs:
      - security_report

  - id: rgpd-review
    name: "2.2 ğŸ›¡ï¸ RGPD Review"
    action: review
    agent: GovAgent
    # Use subagent for isolated context during RGPD analysis
    useSubagent: true
    description: |
      GDPR/RGPD compliance check:
      
      **Data Collection**
      - [ ] Personal data identified
      - [ ] Legal basis for processing
      - [ ] Data minimization applied
      
      **User Rights**
      - [ ] Right to access
      - [ ] Right to rectification
      - [ ] Right to erasure
      
      **Governance**
      - [ ] Data retention period
      - [ ] Third-party processors
      - [ ] Privacy by design
    inputs:
      spec: "spec_document"
    outputs:
      - rgpd_report
    # Require approval after validations before planning
    requiresApproval: true
    approvalMessage: "Review validation results before creating implementation plan"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 3: PLANNING
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: create-plan
    name: "3. Create Implementation Plan"
    action: call_agent
    agent: PlanAgent
    description: |
      Create a detailed implementation plan incorporating validation feedback.
      
      Include:
      - Technical approach
      - Components to create/modify
      - Security measures to implement
      - RGPD compliance measures
      - Dependencies and order
      - Risk assessment
    inputs:
      spec: "spec_document"
      reviews: ["security_report", "rgpd_report"]
    outputs:
      - plan_document

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 4: TASKS
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: generate-tasks
    name: "4. Generate Tasks"
    action: call_agent
    agent: PlanAgent
    description: |
      Break down the plan into atomic tasks.
      
      Each task should:
      - Be completable in 1-2 hours
      - Have clear acceptance criteria
      - Include security/RGPD considerations
      - Be independently testable
    inputs:
      source: "plan_document"
    outputs:
      - tasks_document
    # Critical checkpoint before implementation
    requiresApproval: true
    approvalMessage: "âš ï¸ Implementation will begin after approval. Review tasks carefully."

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 5: IMPLEMENTATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: implement
    name: "5. Implement"
    action: call_agent
    agent: SpecAgent
    description: |
      Implement the tasks following security and RGPD guidelines.
      
      For each task:
      - Implement following project conventions
      - Apply security measures
      - Ensure RGPD compliance
      - Write appropriate tests
      - Update task status when complete
    inputs:
      source: "tasks_document"
    outputs:
      - implementation
