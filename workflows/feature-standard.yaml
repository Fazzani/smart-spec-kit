# Feature Standard Workflow
# Used for creating functional specifications from Azure DevOps Feature work items

name: feature-standard
displayName: "Feature Specification"
description: "Creates a complete functional specification document from an Azure DevOps Feature work item"

metadata:
  version: "1.0"
  author: "Spec-Kit"
  tags:
    - feature
    - specification
    - functional

template: functional-spec.md
defaultAgent: SpecAgent

steps:
  - id: fetch-workitem
    name: "Fetch Azure DevOps Work Item"
    action: fetch_ado
    description: |
      Retrieve the Feature work item from Azure DevOps.
      Extract: Title, Description, Acceptance Criteria, Tags, Links, and Parent/Child relationships.
    outputs:
      - workitem_data
      - linked_items

  - id: analyze-requirements
    name: "Analyze Requirements"
    action: call_agent
    agent: SpecAgent
    description: |
      Analyze the work item data to identify:
      - Core functional requirements
      - Non-functional requirements (performance, security, etc.)
      - User personas and use cases
      - Dependencies and constraints
      - Risks and assumptions
    inputs:
      source: "workitem_data"
    outputs:
      - requirements_analysis

  - id: generate-spec
    name: "Generate Specification Document"
    action: generate_content
    agent: SpecAgent
    description: |
      Using the template and analyzed requirements, generate the functional specification.
      
      Guidelines:
      - Fill all sections with available data
      - Mark unclear sections with [TO FILL] for human review
      - Include traceability links to Azure DevOps
      - Follow the template structure strictly
    inputs:
      template: "functional-spec.md"
      data: "requirements_analysis"
    outputs:
      - spec_document

  - id: review-spec
    name: "Review & Validate"
    action: review
    agent: GovAgent
    description: |
      Review the generated specification for:
      - Completeness (all required sections filled)
      - Consistency (no contradictions)
      - Clarity (understandable by all stakeholders)
      - Traceability (links to source requirements)
      
      Suggest improvements if needed.
    inputs:
      document: "spec_document"
    outputs:
      - review_feedback
      - validated_spec

  - id: create-file
    name: "Save Specification"
    action: create_file
    description: |
      Save the validated specification as a Markdown file.
      Suggested location: `specs/{workitem_id}-functional-spec.md`
    inputs:
      content: "validated_spec"
      filename_pattern: "{context_id}-functional-spec.md"
    outputs:
      - file_path
