# Full Feature Workflow with Governance
# Complete workflow with all validation checkpoints

name: feature-full
displayName: "Feature with Full Governance"
description: "Complete feature workflow including RGPD, Security, Architecture, Design System, and Testing validations"

metadata:
  version: "1.0"
  author: "Spec-Kit"
  tags:
    - feature
    - governance
    - enterprise

template: functional-spec.md
defaultAgent: SpecAgent

steps:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 1: SPECIFICATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  - id: fetch-requirements
    name: "1.1 Fetch Requirements"
    action: fetch_ado
    description: |
      Retrieve the Feature work item and all linked items from Azure DevOps.
      
      Extract:
      - Title and description
      - Acceptance criteria
      - Parent Epic context
      - Linked User Stories
      - Attachments (mockups, documents)
    outputs:
      - workitem_data
      - linked_items
      - attachments

  - id: write-spec
    name: "1.2 Write Functional Specification"
    action: call_agent
    agent: SpecAgent
    description: |
      Generate a comprehensive functional specification including:
      
      **Functional Requirements**
      - User stories with acceptance criteria
      - Business rules
      - Data requirements
      
      **Non-Functional Requirements**
      - Performance targets
      - Availability requirements
      - Scalability needs
      
      Mark uncertain sections with [TO FILL] for human review.
    inputs:
      source: "workitem_data"
    outputs:
      - functional_spec

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 2: VALIDATION GATES
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: rgpd-review
    name: "2.1 ğŸ›¡ï¸ RGPD Compliance Review"
    action: review
    agent: GovAgent
    description: |
      Validate GDPR/RGPD compliance:
      
      **Data Collection**
      - [ ] Personal data identified and documented
      - [ ] Legal basis for processing defined
      - [ ] Data minimization principle applied
      
      **User Rights**
      - [ ] Right to access implemented
      - [ ] Right to rectification supported
      - [ ] Right to erasure (RTBF) supported
      - [ ] Data portability considered
      
      **Security & Governance**
      - [ ] Data retention period defined
      - [ ] Third-party processors identified
      - [ ] Privacy by design applied
      - [ ] DPIA required? (if high risk)
    inputs:
      spec: "functional_spec"
    outputs:
      - rgpd_report
      - rgpd_status

  - id: security-review
    name: "2.2 ğŸ”’ Security Review"
    action: review
    agent: GovAgent
    description: |
      Security assessment checklist:
      
      **Authentication & Authorization**
      - [ ] Auth mechanism defined
      - [ ] Role-based access control
      - [ ] Session management
      
      **Data Protection**
      - [ ] Encryption at rest
      - [ ] Encryption in transit (TLS)
      - [ ] Sensitive data handling
      
      **Input/Output Security**
      - [ ] Input validation strategy
      - [ ] Output encoding
      - [ ] SQL injection prevention
      - [ ] XSS prevention
      - [ ] CSRF protection
      
      **Infrastructure**
      - [ ] Secrets management
      - [ ] Logging (without PII)
      - [ ] Rate limiting
      - [ ] DDoS considerations
    inputs:
      spec: "functional_spec"
    outputs:
      - security_report
      - security_status

  - id: architecture-review
    name: "2.3 ğŸ—ï¸ Architecture Review"
    action: review
    agent: GovAgent
    description: |
      Architecture validation:
      
      **Consistency**
      - [ ] Aligns with existing architecture
      - [ ] Follows established patterns
      - [ ] Uses approved technologies
      
      **Quality Attributes**
      - [ ] Scalability addressed
      - [ ] Performance requirements met
      - [ ] Reliability/Availability design
      - [ ] Maintainability considered
      
      **Technical Debt**
      - [ ] No unnecessary complexity
      - [ ] Reuses existing components
      - [ ] Technical debt acceptable
      
      **Integration**
      - [ ] API contracts defined
      - [ ] Event/message schemas
      - [ ] Database changes documented
    inputs:
      spec: "functional_spec"
    outputs:
      - architecture_report
      - architecture_status

  - id: design-review
    name: "2.4 ğŸ¨ Design System Review"
    action: review
    agent: GovAgent
    description: |
      Design System compliance (if UI involved):
      
      **Components**
      - [ ] Uses Design System components
      - [ ] No unauthorized custom components
      - [ ] Proper component composition
      
      **Visual Consistency**
      - [ ] Color tokens used correctly
      - [ ] Typography follows guidelines
      - [ ] Spacing uses standard scale
      - [ ] Icons from approved library
      
      **Accessibility (WCAG 2.1 AA)**
      - [ ] Color contrast ratios
      - [ ] Keyboard navigation
      - [ ] Screen reader support
      - [ ] Focus indicators
      
      **Responsive Design**
      - [ ] Mobile breakpoints defined
      - [ ] Touch targets adequate
      - [ ] Dark mode support (if applicable)
    inputs:
      spec: "functional_spec"
    outputs:
      - design_report
      - design_status

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 3: TECHNICAL PLANNING
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: technical-plan
    name: "3.1 Technical Planning"
    action: call_agent
    agent: PlanAgent
    description: |
      Create detailed technical plan:
      
      **Architecture Decisions**
      - Components to create/modify
      - Database schema changes
      - API endpoints
      - Integration points
      
      **Task Breakdown**
      - Granular tasks (1-3 days each)
      - Clear acceptance criteria
      - Dependencies mapped
      - Effort estimates (S/M/L/XL)
      
      **Risk Mitigation**
      - Technical risks identified
      - Mitigation strategies
      - Spike tasks if needed
    inputs:
      spec: "functional_spec"
      reviews: ["rgpd_report", "security_report", "architecture_report"]
    outputs:
      - technical_plan
      - task_list

  - id: test-strategy
    name: "3.2 ğŸ§ª Test Strategy"
    action: call_agent
    agent: TestAgent
    description: |
      Define comprehensive test strategy:
      
      **Unit Tests**
      - Critical business logic
      - Edge cases
      - Error handling
      - Target: >80% coverage
      
      **Integration Tests**
      - API contracts
      - Database operations
      - External service mocks
      
      **E2E Tests**
      - Critical user journeys
      - Happy path scenarios
      - Key error scenarios
      
      **Non-Functional Tests**
      - Performance benchmarks
      - Load testing thresholds
      - Security scan requirements
    inputs:
      spec: "functional_spec"
      plan: "technical_plan"
    outputs:
      - test_strategy
      - test_cases

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 4: DOCUMENTATION & FINALIZATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: documentation
    name: "4.1 ğŸ“š Documentation Plan"
    action: generate_content
    description: |
      Identify documentation needs:
      
      **User Documentation**
      - [ ] User guide updates
      - [ ] FAQ additions
      - [ ] Tutorial/walkthrough
      
      **Technical Documentation**
      - [ ] API documentation
      - [ ] Architecture Decision Record (ADR)
      - [ ] Runbook updates
      - [ ] README updates
      
      **Release Documentation**
      - [ ] Changelog entry
      - [ ] Release notes
      - [ ] Migration guide (if breaking changes)
    inputs:
      spec: "functional_spec"
      plan: "technical_plan"
    outputs:
      - documentation_plan

  - id: final-approval
    name: "4.2 âœ… Final Approval Gate"
    action: review
    agent: GovAgent
    description: |
      Final checklist before development starts:
      
      **Specification**
      - [ ] Functional spec complete and approved
      - [ ] All [TO FILL] sections resolved
      - [ ] Stakeholder sign-off obtained
      
      **Compliance**
      - [ ] RGPD review: PASSED
      - [ ] Security review: PASSED
      - [ ] Architecture review: PASSED
      - [ ] Design review: PASSED (if applicable)
      
      **Planning**
      - [ ] Technical plan approved
      - [ ] Tasks created in ADO
      - [ ] Test strategy defined
      - [ ] Documentation plan ready
      
      **Ready for Development** âœ…
    inputs:
      all_artifacts: true
    outputs:
      - final_approval
      - development_ready

  - id: create-tasks
    name: "4.3 Create ADO Work Items"
    action: create_file
    description: |
      Generate Azure DevOps work items:
      - Create Tasks from technical plan
      - Link to parent Feature
      - Set estimates and priorities
      - Assign to sprint
      
      Output format ready for ADO import or manual creation.
    inputs:
      tasks: "task_list"
      feature_id: "context_id"
    outputs:
      - ado_work_items
